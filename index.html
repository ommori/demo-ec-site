<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    script-src 'self' 'unsafe-inline' https://api-jp.signals.ngxint.com https://api-jp.signals.engageplatform.com https://www.googletagmanager.com https://www.googletagmanager.com;
    connect-src 'self' https://api-jp.signals.ngxint.com https://api-jp.signals.engageplatform.com https://api-jp.signals.ngxint.com:443 https://api-jp.signals.engageplatform.com:443;
    img-src 'self' data: https://via.placeholder.com;
    style-src 'self' 'unsafe-inline';
    object-src 'none';
    frame-ancestors 'none';
  ">
  <script>
    // fetch をログ（CSP が通った後の動作確認用）
    (function(){
        if(!window._fetch_wrapped){
            window._fetch_wrapped = true;
            const _fetch = window.fetch;
            window.fetch = function(input, init){
                const url = (typeof input === 'string') ? input : (input && input.url);
                console.log('[DEBUG] fetch called:', url, init && init.method);
                return _fetch.apply(this, arguments);
            };
        }
    })();
    
    // XHR をログ
    (function(){
        if(!XMLHttpRequest.prototype._open_wrapped){
            XMLHttpRequest.prototype._open_wrapped = true;
            const _open = XMLHttpRequest.prototype.open;
            XMLHttpRequest.prototype.open = function(method, url){
                try { console.log('[DEBUG] XHR open:', method, url); } catch(e){}
                return _open.apply(this, arguments);
            };
        }
    })();
  </script>
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-MRSX7MPX');</script>
  <!-- End Google Tag Manager -->
  <title>MMX Test Pages — Index</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { font-family: Arial, sans-serif; padding: 24px; background:#f7f7f7; color:#222; }
    .container { max-width:720px; margin:0 auto; background:#fff; padding:20px; border-radius:6px; box-shadow:0 2px 6px rgba(0,0,0,0.08); }
    h1 { margin-top:0; }
    p { color:#555; }
    .links { margin-top:18px; display:flex; gap:12px; flex-wrap:wrap; }
    a.button {
      display:inline-block; padding:10px 14px; background:#0073e6; color:#fff; text-decoration:none; border-radius:4px;
      box-shadow:0 1px 0 rgba(0,0,0,0.08);
    }
    a.button.secondary { background:#6c757d; }
    small { color:#888; display:block; margin-top:12px; }
  </style>
</head>
<body>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MRSX7MPX"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
  <div class="container">
    <h1>MMX テストページ インデックス</h1>
    <p>以下のリンクからテスト用の Add To Cart ページへ移動できます。両方のファイル（index.html と test-mmx-add-to-cart.html）を同じフォルダに置いてください。</p>

    <div class="links">
      <a class="button" href="test-mmx-add-to-cart.html" target="_blank" rel="noopener noreferrer">Open test-mmx-add-to-cart.html</a>
      <a class="button secondary" href="test-mmx-add-to-cart.html">Open in same tab</a>
    </div>

    <small>注意: test-mmx-add-to-cart.html 内の GTM コンテナ ID（GTM-XXXX）を必ず実際の ID に置き換えてください。GTM プレビューで動作確認してください。</small>
  </div>
</body>
</html>